{% extends 'layouts/base.html' %} {% block content %}
<div class="header bg-primary pb-6">
  <div class="container-fluid">
    <div class="header-body">
      <div class="row align-items-center py-4">
        <div class="col-lg-6 col-5">
          <h6 class="h2 text-white d-inline-block mb-0">
            Información del Paciente
          </h6>
          <nav aria-label="breadcrumb" class="d-none d-md-inline-block ml-md-4">
            <ol class="breadcrumb breadcrumb-links breadcrumb-dark">
              <li class="breadcrumb-item">
                <a href="#"><i class="fas fa-home"></i></a>
              </li>
              <li class="breadcrumb-item">
                <a href="/pacientes/">Pacientes</a>
              </li>
              <li class="breadcrumb-item"><a href="/pacientes/">Volver</a></li>
            </ol>
          </nav>
        </div>
      </div>
    </div>
  </div>
</div>
<form method="post" action="{% url 'guardar_examen_anamnesis' %}">
  {% csrf_token %}
  <div class="container-fluid mt--6">
    <div class="row">
      <div class="col">
        <div class="card">
          <div class="card-header border-0">
            <div class="row align-items-center">
              <div class="col">
                <h3 class="mb-0">Anamnesis de Sueño</h3>
                <input type="hidden" name="visita_examen" id="visita_examen" value="{{ visita_examen }}" />
                <input type="hidden" name="paciente_id" id="paciente_id" value="{{ paciente_id }}" />
              </div>
            </div>
          </div>
          <div class="card-body">
            <!-- Sección: Motivo de consulta y Enfermedad actual -->
            <div class="form-group">
              <label for="motivo_consulta">Motivo de consulta</label>
              <textarea class="form-control" id="motivo_consulta" name="motivo_consulta" rows="3"></textarea>
            </div>
            <div class="form-group">
              <label for="enfermedad_actual">Enfermedad actual</label>
              <textarea class="form-control" id="enfermedad_actual" name="enfermedad_actual" rows="3"></textarea>
            </div>

            <hr class="my-4" />
            <!-- Sección: Queja de sueño -->
            <h4 class="mt-4 mb-3">Queja de sueño</h4>
            <div class="form-group">
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="queja_sueno" name="queja_sueno" value="si" />
                <label class="custom-control-label" for="queja_sueno">Queja de sueño</label>
              </div>
            </div>

            <!-- Quejas de sueño -->
            <h4 class="mt-4 mb-3">Queja de sueño</h4>
            <div class="form-group">
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input queja-checkbox" id="dificultad_conciliacion"
                  name="tipo_queja[]" value="Dificultad de conciliación" />
                <label class="custom-control-label" for="dificultad_conciliacion">Dificultad de conciliación</label>
              </div>
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input queja-checkbox" id="ronquido" name="tipo_queja[]"
                  value="Ronquido" />
                <label class="custom-control-label" for="ronquido">Ronquido</label>
              </div>
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input queja-checkbox" id="apnea" name="tipo_queja[]"
                  value="Apnea" />
                <label class="custom-control-label" for="apnea">Apnea</label>
              </div>
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input queja-checkbox" id="hipersomnolencia"
                  name="tipo_queja[]" value="Hipersomnolencia" />
                <label class="custom-control-label" for="hipersomnolencia">Hipersomnolencia</label>
              </div>
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input queja-checkbox" id="somnolencia_diurna"
                  name="tipo_queja[]" value="Somnolencia diurna" />
                <label class="custom-control-label" for="somnolencia_diurna">Somnolencia diurna</label>
              </div>
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input queja-checkbox" id="dificultad_mantenimiento"
                  name="tipo_queja[]" value="Dificultad mantenimiento" />
                <label class="custom-control-label" for="dificultad_mantenimiento">Dificultad mantenimiento</label>
              </div>
            </div>

            <!-- Contenedor donde se agregarán los campos dinámicamente -->
            <div id="quejas-container"></div>

            <div class="form-group">
              <label>Existe alguna causa conocida o a la que le atribuya el problema</label>
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="causa_conocida" name="causa_conocida"
                  value="si" />
                <label class="custom-control-label" for="causa_conocida">Sí</label>
              </div>
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="no_causa_conocida" name="causa_conocida"
                  value="no" />
                <label class="custom-control-label" for="no_causa_conocida">No</label>
              </div>
            </div>

            <div class="form-group" id="especifique-causas">
              <label for="especifique_causas">Especifique cuál o cuáles causas</label>
              <textarea class="form-control" id="especifique_causas" name="especifique_causas" rows="2"></textarea>
            </div>

            <div class="form-group">
              <label for="observaciones_queja">Observaciones</label>
              <textarea class="form-control" id="observaciones_queja" name="observaciones_queja" rows="2"></textarea>
            </div>

            <hr class="my-4" />
            <!-- Sección: Horario de sueño -->
            <h4 class="mt-4 mb-3">Horario de sueño</h4>
            <div class="form-group">
              <label>¿Tiene alguna rutina antes de dormir?</label>
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="rutina_si" name="rutina_dormir" value="si" />
                <label class="custom-control-label" for="rutina_si">Sí</label>
              </div>
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="rutina_no" name="rutina_dormir" value="no" />
                <label class="custom-control-label" for="rutina_no">No</label>
              </div>
            </div>

            <div class="form-group" id="describa-rutina">
              <label for="describa_rutina">Describa</label>
              <textarea class="form-control" id="describa_rutina" name="describa_rutina" rows="2"></textarea>
            </div>

            <hr class="my-4" />
            <!-- Horario sueño - Jornada Laboral -->
            <h5 class="mt-3 mb-2">
              Horario de sueño en jornada laboral / Académica - Lunes a Viernes
            </h5>
            <div class="form-group">
              <label>Horario Jornada Académica / Laboral Lunes a Viernes</label>
              <div class="ml-3">
                <div class="custom-control custom-checkbox">
                  <input type="checkbox" class="custom-control-input" id="jornada_diurna" name="jornada_laboral[]"
                    value="Diurna" />
                  <label class="custom-control-label" for="jornada_diurna">Diurna</label>
                </div>
                <div class="custom-control custom-checkbox">
                  <input type="checkbox" class="custom-control-input" id="jornada_nocturna" name="jornada_laboral[]"
                    value="Nocturna" />
                  <label class="custom-control-label" for="jornada_nocturna">Nocturna</label>
                </div>
                <div class="custom-control custom-checkbox">
                  <input type="checkbox" class="custom-control-input" id="jornada_mixta" name="jornada_laboral[]"
                    value="Mixta" />
                  <label class="custom-control-label" for="jornada_mixta">Mixta</label>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-md-6">
                <div class="form-group">
                  <label for="hora_acostarse_laboral">Hora aproximada de acostarse</label>
                  <input type="text" class="form-control" id="hora_acostarse_laboral" name="hora_acostarse_laboral"
                    placeholder="hh:mm" />
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-group">
                  <label for="tiempo_dormirse_laboral">Cuanto tiempo le toma quedarse dormido(a) (en minutos)</label>
                  <input type="number" class="form-control" id="tiempo_dormirse_laboral"
                    name="tiempo_dormirse_laboral" />
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-md-6">
                <div class="form-group">
                  <label for="hora_intencion_dormir_laboral">Hora aproximada de intención de dormir</label>
                  <input type="text" class="form-control" id="hora_intencion_dormir_laboral"
                    name="hora_intencion_dormir_laboral" placeholder="hh:mm" />
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-group">
                  <label for="hora_despertar_laboral">Hora aproximada de despertarse</label>
                  <input type="text" class="form-control" id="hora_despertar_laboral" name="hora_despertar_laboral"
                    placeholder="hh:mm" />
                </div>
              </div>
            </div>

            <div class="form-group">
              <label for="tiempo_salir_cama_laboral">Cuánto tiempo le toma para salir de la cama (en minutos)</label>
              <input type="number" class="form-control" id="tiempo_salir_cama_laboral"
                name="tiempo_salir_cama_laboral" />
            </div>

            <div class="row">
              <div class="col-md-4">
                <div class="form-group">
                  <label>El sueño es reparador</label>
                  <div class="custom-control custom-checkbox">
                    <input type="checkbox" class="custom-control-input" id="sueno_reparador_si_laboral"
                      name="sueno_reparador_laboral" value="Si" />
                    <label class="custom-control-label" for="sueno_reparador_si_laboral">Sí</label>
                  </div>
                  <div class="custom-control custom-checkbox">
                    <input type="checkbox" class="custom-control-input" id="sueno_reparador_no_laboral"
                      name="sueno_reparador_laboral" value="No" />
                    <label class="custom-control-label" for="sueno_reparador_no_laboral">No</label>
                  </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="form-group">
                  <label>Compañero(a) de cama</label>
                  <div class="custom-control custom-checkbox">
                    <input type="checkbox" class="custom-control-input" id="companero_cama_si_laboral"
                      name="companero_cama_laboral" value="Si" />
                    <label class="custom-control-label" for="companero_cama_si_laboral">Sí</label>
                  </div>
                  <div class="custom-control custom-checkbox">
                    <input type="checkbox" class="custom-control-input" id="companero_cama_no_laboral"
                      name="companero_cama_laboral" value="No" />
                    <label class="custom-control-label" for="companero_cama_no_laboral">No</label>
                  </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="form-group">
                  <label>¿Necesita despertador?</label>
                  <div class="custom-control custom-checkbox">
                    <input type="checkbox" class="custom-control-input" id="despertador_si_laboral"
                      name="despertador_laboral" value="Si" />
                    <label class="custom-control-label" for="despertador_si_laboral">Sí</label>
                  </div>
                  <div class="custom-control custom-checkbox">
                    <input type="checkbox" class="custom-control-input" id="despertador_no_laboral"
                      name="despertador_laboral" value="No" />
                    <label class="custom-control-label" for="despertador_no_laboral">No</label>
                  </div>
                </div>
              </div>
            </div>

            <hr class="my-4" />
            <!-- Horario sueño - Fines de semana -->
            <h5 class="mt-4 mb-2">Horario de sueño en fines de semana</h5>
            <div class="form-group">
              <label>Horario Jornada Académica / Laboral Fines de semana</label>
              <div class="ml-3">
                <div class="custom-control custom-checkbox">
                  <input type="checkbox" class="custom-control-input" id="jornada_diurna_fds" name="jornada_fds[]"
                    value="Diurna" />
                  <label class="custom-control-label" for="jornada_diurna_fds">Diurna</label>
                </div>
                <div class="custom-control custom-checkbox">
                  <input type="checkbox" class="custom-control-input" id="jornada_nocturna_fds" name="jornada_fds[]"
                    value="Nocturna" />
                  <label class="custom-control-label" for="jornada_nocturna_fds">Nocturna</label>
                </div>
                <div class="custom-control custom-checkbox">
                  <input type="checkbox" class="custom-control-input" id="jornada_mixta_fds" name="jornada_fds[]"
                    value="Mixta" />
                  <label class="custom-control-label" for="jornada_mixta_fds">Mixta</label>
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-md-6">
                <div class="form-group">
                  <label for="hora_acostarse_fds">Hora aproximada de acostarse</label>
                  <input type="text" class="form-control" id="hora_acostarse_fds" name="hora_acostarse_fds"
                    placeholder="hh:mm" />
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-group">
                  <label for="tiempo_dormirse_fds">Cuanto tiempo le toma quedarse dormido(a) (en minutos)</label>
                  <input type="number" class="form-control" id="tiempo_dormirse_fds" name="tiempo_dormirse_fds" />
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-md-6">
                <div class="form-group">
                  <label for="hora_intencion_dormir_fds">Hora aproximada de intención de dormir</label>
                  <input type="text" class="form-control" id="hora_intencion_dormir_fds"
                    name="hora_intencion_dormir_fds" placeholder="hh:mm" />
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-group">
                  <label for="hora_despertar_fds">Hora aproximada de despertarse</label>
                  <input type="text" class="form-control" id="hora_despertar_fds" name="hora_despertar_fds"
                    placeholder="hh:mm" />
                </div>
              </div>
            </div>

            <div class="form-group">
              <label for="tiempo_salir_cama_fds">Cuánto tiempo le toma para salir de la cama (en minutos)</label>
              <input type="number" class="form-control" id="tiempo_salir_cama_fds" name="tiempo_salir_cama_fds" />
            </div>

            <div class="row">
              <div class="col-md-4">
                <div class="form-group">
                  <label>El sueño es reparador</label>
                  <div class="custom-control custom-checkbox">
                    <input type="checkbox" class="custom-control-input" id="sueno_reparador_si_fds"
                      name="sueno_reparador_fds" value="Si" />
                    <label class="custom-control-label" for="sueno_reparador_si_fds">Sí</label>
                  </div>
                  <div class="custom-control custom-checkbox">
                    <input type="checkbox" class="custom-control-input" id="sueno_reparador_no_fds"
                      name="sueno_reparador_fds" value="No" />
                    <label class="custom-control-label" for="sueno_reparador_no_fds">No</label>
                  </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="form-group">
                  <label>Compañero(a) de cama</label>
                  <div class="custom-control custom-checkbox">
                    <input type="checkbox" class="custom-control-input" id="companero_cama_si_fds"
                      name="companero_cama_fds" value="Si" />
                    <label class="custom-control-label" for="companero_cama_si_fds">Sí</label>
                  </div>
                  <div class="custom-control custom-checkbox">
                    <input type="checkbox" class="custom-control-input" id="companero_cama_no_fds"
                      name="companero_cama_fds" value="No" />
                    <label class="custom-control-label" for="companero_cama_no_fds">No</label>
                  </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="form-group">
                  <label>¿Necesita despertador?</label>
                  <div class="custom-control custom-checkbox">
                    <input type="checkbox" class="custom-control-input" id="despertador_si_fds" name="despertador_fds"
                      value="Si" />
                    <label class="custom-control-label" for="despertador_si_fds">Sí</label>
                  </div>
                  <div class="custom-control custom-checkbox">
                    <input type="checkbox" class="custom-control-input" id="despertador_no_fds" name="despertador_fds"
                      value="No" />
                    <label class="custom-control-label" for="despertador_no_fds">No</label>
                  </div>
                </div>
              </div>
            </div>

            <hr class="my-4" />
            <!-- Horario sueño - Vacaciones -->
            <h5 class="mt-4 mb-2">Horario de sueño en vacaciones</h5>
            <div class="row">
              <div class="col-md-6">
                <div class="form-group">
                  <label for="hora_acostarse_vacaciones">Hora aproximada de acostarse</label>
                  <input type="text" class="form-control" id="hora_acostarse_vacaciones"
                    name="hora_acostarse_vacaciones" placeholder="hh:mm" />
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-group">
                  <label for="tiempo_dormirse_vacaciones">Cuanto tiempo le toma quedarse dormido(a) (en minutos)</label>
                  <input type="number" class="form-control" id="tiempo_dormirse_vacaciones"
                    name="tiempo_dormirse_vacaciones" />
                </div>
              </div>
            </div>

            <div class="row">
              <div class="col-md-6">
                <div class="form-group">
                  <label for="hora_intencion_dormir_vacaciones">Hora aproximada de intención de dormir</label>
                  <input type="text" class="form-control" id="hora_intencion_dormir_vacaciones"
                    name="hora_intencion_dormir_vacaciones" placeholder="hh:mm" />
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-group">
                  <label for="hora_despertar_vacaciones">Hora aproximada de despertarse</label>
                  <input type="text" class="form-control" id="hora_despertar_vacaciones"
                    name="hora_despertar_vacaciones" placeholder="hh:mm" />
                </div>
              </div>
            </div>

            <div class="form-group">
              <label for="tiempo_salir_cama_vacaciones">Cuánto tiempo le toma para salir de la cama (en minutos)</label>
              <input type="number" class="form-control" id="tiempo_salir_cama_vacaciones"
                name="tiempo_salir_cama_vacaciones" />
            </div>

            <div class="row">
              <div class="col-md-4">
                <div class="form-group">
                  <label>El sueño es reparador</label>
                  <div class="custom-control custom-checkbox">
                    <input type="checkbox" class="custom-control-input" id="sueno_reparador_si_vac"
                      name="sueno_reparador_vacaciones" value="Si" />
                    <label class="custom-control-label" for="sueno_reparador_si_vac">Sí</label>
                  </div>
                  <div class="custom-control custom-checkbox">
                    <input type="checkbox" class="custom-control-input" id="sueno_reparador_no_vac"
                      name="sueno_reparador_vacaciones" value="No" />
                    <label class="custom-control-label" for="sueno_reparador_no_vac">No</label>
                  </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="form-group">
                  <label>Compañero(a) de cama</label>
                  <div class="custom-control custom-checkbox">
                    <input type="checkbox" class="custom-control-input" id="companero_cama_si_vac"
                      name="companero_cama_vacaciones" value="Si" />
                    <label class="custom-control-label" for="companero_cama_si_vac">Sí</label>
                  </div>
                  <div class="custom-control custom-checkbox">
                    <input type="checkbox" class="custom-control-input" id="companero_cama_no_vac"
                      name="companero_cama_vacaciones" value="No" />
                    <label class="custom-control-label" for="companero_cama_no_vac">No</label>
                  </div>
                </div>
              </div>
              <div class="col-md-4">
                <div class="form-group">
                  <label>¿Necesita despertador?</label>
                  <div class="custom-control custom-checkbox">
                    <input type="checkbox" class="custom-control-input" id="despertador_si_vac"
                      name="despertador_vacaciones" value="Si" />
                    <label class="custom-control-label" for="despertador_si_vac">Sí</label>
                  </div>
                  <div class="custom-control custom-checkbox">
                    <input type="checkbox" class="custom-control-input" id="despertador_no_vac"
                      name="despertador_vacaciones" value="No" />
                    <label class="custom-control-label" for="despertador_no_vac">No</label>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col">
        <div class="card">
          <div class="card-header border-0">
            <div class="row align-items-center">
              <div class="col">
                <h3 class="mb-0">Higiene de sueño</h3>
              </div>
            </div>
          </div>
          <div class="card-body">
            <!-- Sección: Siestas durante el día -->
            <div class="form-group">
              <label>¿Realiza siestas durante el día?</label>
              <div class="custom-control custom-radio">
                <input type="radio" class="custom-control-input" id="siestas_si" name="realiza_siestas" value="Si">
                <label class="custom-control-label" for="siestas_si">Sí</label>
              </div>
              <div class="custom-control custom-radio">
                <input type="radio" class="custom-control-input" id="siestas_no" name="realiza_siestas" value="No">
                <label class="custom-control-label" for="siestas_no">No</label>
              </div>
            </div>

            <!-- Detalles de las siestas (visible si se selecciona "Sí") -->
            <div id="siestas-container" class="pl-4">
              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="numero_siestas">Número de siestas al día</label>
                    <input type="number" class="form-control" id="numero_siestas" name="numero_siestas">
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="duracion_siestas">Duración aproximada (en minutos)</label>
                    <input type="number" class="form-control" id="duracion_siestas" name="duracion_siestas">
                  </div>
                </div>
              </div>

              <!-- Frecuencia de las siestas -->
              <div class="form-group">
                <label>Frecuencia a la semana</label>
                <div class="ml-3">
                  <div class="custom-control custom-radio">
                    <input type="radio" class="custom-control-input" id="siesta_frecuencia_una" name="siesta_frecuencia"
                      value="Una vez">
                    <label class="custom-control-label" for="siesta_frecuencia_una">Una vez</label>
                  </div>
                  <div class="custom-control custom-radio">
                    <input type="radio" class="custom-control-input" id="siesta_frecuencia_dos_tres"
                      name="siesta_frecuencia" value="2-3 veces">
                    <label class="custom-control-label" for="siesta_frecuencia_dos_tres">2-3 veces</label>
                  </div>
                  <div class="custom-control custom-radio">
                    <input type="radio" class="custom-control-input" id="siesta_frecuencia_cuatro_cinco"
                      name="siesta_frecuencia" value="4-5 veces">
                    <label class="custom-control-label" for="siesta_frecuencia_cuatro_cinco">4-5 veces</label>
                  </div>
                  <div class="custom-control custom-radio">
                    <input type="radio" class="custom-control-input" id="siesta_frecuencia_mas_cinco"
                      name="siesta_frecuencia" value="> 5 veces">
                    <label class="custom-control-label" for="siesta_frecuencia_mas_cinco">> 5 veces</label>
                  </div>
                </div>
              </div>

              <!-- Momento del día de las siestas -->
              <div class="form-group">
                <label>Momento del día en que realiza siestas</label>
                <div class="custom-control custom-checkbox">
                  <input type="checkbox" class="custom-control-input" id="manana" name="momento_dia" value="Mañana">
                  <label class="custom-control-label" for="manana">Mañana</label>
                </div>
                <div class="custom-control custom-checkbox">
                  <input type="checkbox" class="custom-control-input" id="tarde" name="momento_dia" value="Tarde">
                  <label class="custom-control-label" for="tarde">Tarde</label>
                </div>
                <div class="custom-control custom-checkbox">
                  <input type="checkbox" class="custom-control-input" id="noche" name="momento_dia" value="Noche">
                  <label class="custom-control-label" for="noche">Noche</label>
                </div>
                <div class="custom-control custom-checkbox">
                  <input type="checkbox" class="custom-control-input" id="variable" name="momento_dia" value="Variable">
                  <label class="custom-control-label" for="variable">Variable</label>
                </div>
              </div>

              <!-- ¿La siesta es reparadora? -->
              <div class="form-group">
                <label>¿La siesta es reparadora?</label>
                <div class="custom-control custom-radio">
                  <input type="radio" class="custom-control-input" id="siesta_reparadora_si" name="siesta_reparadora"
                    value="Si">
                  <label class="custom-control-label" for="siesta_reparadora_si">Sí</label>
                </div>
                <div class="custom-control custom-radio">
                  <input type="radio" class="custom-control-input" id="siesta_reparadora_no" name="siesta_reparadora"
                    value="No">
                  <label class="custom-control-label" for="siesta_reparadora_no">No</label>
                </div>
              </div>

              <!-- Periodo en el que realiza las siestas -->
              <div class="form-group">
                <label>Periodo en el que realiza las siestas</label>
                <select class="form-control" name="periodo_siestas">
                  <option value="Jornada laboral / académica">Jornada laboral / académica</option>
                  <option value="Fines de Semana">Fines de Semana</option>
                  <option value="Vacaciones">Vacaciones</option>
                </select>
              </div>
            </div>

            <!-- Sección: Características del lugar donde duerme -->
            <h4 class="mt-4 mb-3">Características del lugar donde duerme</h4>

            <!-- Condiciones de iluminación -->
            <div class="form-group">
              <label>Condiciones de iluminación</label>
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="muy_iluminado" name="iluminacion"
                  value="Muy iluminado">
                <label class="custom-control-label" for="muy_iluminado">Muy iluminado</label>
              </div>
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="levemente_iluminado" name="iluminacion"
                  value="Levemente iluminado">
                <label class="custom-control-label" for="levemente_iluminado">Levemente iluminado</label>
              </div>
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="levemente_oscuro" name="iluminacion"
                  value="Levemente oscuro">
                <label class="custom-control-label" for="levemente_oscuro">Levemente oscuro</label>
              </div>
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="muy_oscuro" name="iluminacion"
                  value="Muy oscuro">
                <label class="custom-control-label" for="muy_oscuro">Muy oscuro</label>
              </div>
            </div>

            <!-- Comodidad del espacio -->
            <div class="form-group">
              <label>Comodidad del espacio</label>
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="muy_incomodo" name="comodidad"
                  value="Muy incómodo">
                <label class="custom-control-label" for="muy_incomodo">Muy incómodo</label>
              </div>
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="levemente_incomodo" name="comodidad"
                  value="Levemente incómodo">
                <label class="custom-control-label" for="levemente_incomodo">Levemente incómodo</label>
              </div>
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="levemente_comodo" name="comodidad"
                  value="Levemente cómodo">
                <label class="custom-control-label" for="levemente_comodo">Levemente cómodo</label>
              </div>
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="muy_comodo" name="comodidad" value="Muy cómodo">
                <label class="custom-control-label" for="muy_comodo">Muy cómodo</label>
              </div>
            </div>

            <!-- Condiciones de ruido -->
            <div class="form-group">
              <label>Condiciones de ruido</label>
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="muy_ruidoso" name="ruido" value="Muy ruidoso">
                <label class="custom-control-label" for="muy_ruidoso">Muy ruidoso</label>
              </div>
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="levemente_ruidoso" name="ruido"
                  value="Levemente ruidoso">
                <label class="custom-control-label" for="levemente_ruidoso">Levemente ruidoso</label>
              </div>
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="levemente_silencioso" name="ruido"
                  value="Levemente silencioso">
                <label class="custom-control-label" for="levemente_silencioso">Levemente silencioso</label>
              </div>
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input" id="muy_silencioso" name="ruido"
                  value="Muy silencioso">
                <label class="custom-control-label" for="muy_silencioso">Muy silencioso</label>
              </div>
            </div>

            <!-- Consumo de comidas o bebidas antes de dormir ---------------------------------------->
            <div class="form-group">
              <label class="form-label">¿Consume comidas o bebidas antes de dormir?</label>
              <div class="custom-control custom-radio">
                <input type="radio" class="custom-control-input" id="consume-si" name="consume" value="si">
                <label class="custom-control-label" for="consume-si">Sí</label>
              </div>
              <div class="custom-control custom-radio">
                <input type="radio" class="custom-control-input" id="consume-no" name="consume" value="no" checked>
                <label class="custom-control-label" for="consume-no">No</label>
              </div>
            </div>

            <!-- Campos adicionales (se muestran si se selecciona "Sí") -->
            <div id="campos-comida-container" style="display: none;">
              <!-- Botón para agregar sustancias -->
              <button type="button" id="agregar-sustancia" class="btn btn-primary mb-3">Agregar sustancia</button>

              <!-- Contenedor dinámico para las sustancias -->
              <div id="contenedor-sustancias"></div>
            </div>

            <!-- Pregunta sobre consumo de medicamentos -->
            <div class="form-group">
              <label>¿Consume algún medicamento u otro tipo de sustancias?</label>
              <div class="custom-control custom-radio">
                <input type="radio" class="custom-control-input" id="consume_si" name="consume_medicamento" value="Si">
                <label class="custom-control-label" for="consume_si">Sí</label>
              </div>
              <div class="custom-control custom-radio">
                <input type="radio" class="custom-control-input" id="consume_no" name="consume_medicamento" value="No">
                <label class="custom-control-label" for="consume_no">No</label>
              </div>
            </div>

            <!-- Botón para agregar medicamentos -->
            <button id="agregar-medicamento" class="btn btn-primary" style="display: none;">Agregar Medicamento</button>

            <!-- Contenedor dinámico para los medicamentos -->
            <div id="contenedor-medicamentos" class="mt-3"></div>

            <!-- Pregunta sobre uso de pantallas antes de dormir -->
            <div class="form-group">
              <label>¿Utiliza pantallas cerca al horario de dormir?</label>
              <div class="custom-control custom-radio">
                <input type="radio" class="custom-control-input" id="pantallas_si" name="usa_pantallas" value="Si">
                <label class="custom-control-label" for="pantallas_si">Sí</label>
              </div>
              <div class="custom-control custom-radio">
                <input type="radio" class="custom-control-input" id="pantallas_no" name="usa_pantallas" value="No">
                <label class="custom-control-label" for="pantallas_no">No</label>
              </div>
            </div>

            <!-- Botón para agregar información sobre pantallas -->
            <button id="agregar-pantalla" type="button" class="btn btn-primary" style="display: none;">Agregar
              Pantalla</button>

            <!-- Contenedor dinámico para las pantallas -->
            <div id="contenedor-pantallas" class="mt-3"></div>

            <!-- Pregunta sobre uso de la cama para otras actividades -->
            <div class="form-group">
              <label>¿Utiliza la cama para actividades diferentes a dormir y relaciones sexuales?</label>
              <div class="custom-control custom-radio">
                <input type="radio" class="custom-control-input" id="cama_actividades_si" name="cama_actividades"
                  value="Si">
                <label class="custom-control-label" for="cama_actividades_si">Sí</label>
              </div>
              <div class="custom-control custom-radio">
                <input type="radio" class="custom-control-input" id="cama_actividades_no" name="cama_actividades"
                  value="No">
                <label class="custom-control-label" for="cama_actividades_no">No</label>
              </div>
            </div>

            <!-- Botón para agregar información sobre actividades en la cama -->
            <button id="agregar-actividad" type="button" class="btn btn-primary" style="display: none;">Agregar
              Actividad</button>

            <!-- Contenedor dinámico para las actividades -->
            <div id="contenedor-actividades" class="mt-3"></div>

            <!-- Pregunta sobre actividad física durante el día -->
            <div class="form-group">
              <label>¿Realiza actividad física durante el día?</label>
              <div class="custom-control custom-radio">
                <input type="radio" class="custom-control-input" id="actividad_fisica_si" name="actividad_fisica"
                  value="Si">
                <label class="custom-control-label" for="actividad_fisica_si">Sí</label>
              </div>
              <div class="custom-control custom-radio">
                <input type="radio" class="custom-control-input" id="actividad_fisica_no" name="actividad_fisica"
                  value="No">
                <label class="custom-control-label" for="actividad_fisica_no">No</label>
              </div>
            </div>

            <!-- Botón para agregar información sobre actividades físicas -->
            <button id="agregar-actividad-fisica" type="button" class="btn btn-primary" style="display: none;">Agregar
              Actividad Física</button>

            <!-- Contenedor dinámico para las actividades físicas -->
            <div id="contenedor-actividades-fisicas" class="mt-3"></div>


          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col">
        <div class="card">
          <div class="card-header border-0">
            <div class="row align-items-center">
              <div class="col">
                <h3 class="mb-0">Síntomas asociados al sueño</h3>
              </div>
            </div>
          </div>
          <div class="card-body">
            <!-- Pregunta sobre síntomas asociados al sueño -->
            <div class="form-group">
              <label>¿Presenta algún síntoma diferente asociado al sueño?</label>
              <div class="custom-control custom-radio">
                <input type="radio" class="custom-control-input" id="sintomas_sueno_si" name="sintomas_sueno"
                  value="Si">
                <label class="custom-control-label" for="sintomas_sueno_si">Sí</label>
              </div>
              <div class="custom-control custom-radio">
                <input type="radio" class="custom-control-input" id="sintomas_sueno_no" name="sintomas_sueno"
                  value="No">
                <label class="custom-control-label" for="sintomas_sueno_no">No</label>
              </div>
            </div>

            <!-- Botón para agregar información sobre síntomas -->
            <button id="agregar-sintoma" type="button" class="btn btn-primary" style="display: none;">Agregar
              Síntoma</button>

            <!-- Contenedor dinámico para los síntomas -->
            <div id="contenedor-sintomas" class="mt-3"></div>

            <!-- Pregunta sobre síntomas durante el funcionamiento diurno -->
            <div class="form-group">
              <label>¿Presenta algún síntoma durante el funcionamiento diurno?</label>
              <div class="custom-control custom-radio">
                <input type="radio" class="custom-control-input" id="sintomas_diurnos_si" name="sintomas_diurnos"
                  value="Si">
                <label class="custom-control-label" for="sintomas_diurnos_si">Sí</label>
              </div>
              <div class="custom-control custom-radio">
                <input type="radio" class="custom-control-input" id="sintomas_diurnos_no" name="sintomas_diurnos"
                  value="No">
                <label class="custom-control-label" for="sintomas_diurnos_no">No</label>
              </div>
            </div>

            <!-- Botón para agregar información sobre síntomas diurnos -->
            <button id="agregar-sintoma-diurno" type="button" class="btn btn-primary" style="display: none;">Agregar
              Síntoma Diurno</button>

            <!-- Contenedor dinámico para los síntomas diurnos -->
            <div id="contenedor-sintomas-diurnos" class="mt-3"></div>

          </div>
        </div>
      </div>
    </div>
    <!-- Botones de acción -->
    <div class="row">
      <div class="col-12 text-right">
        <button type="submit" class="btn btn-primary">Guardar Examen</button>
        <a href="{% url 'detalle_paciente' paciente_id %}" class="btn btn-primary">Ver Paciente</a>
      </div>
    </div>
  </div>
</form>



{% block javascripts %}
<script>
  let contador = 0;
  document.addEventListener("DOMContentLoaded", function () {
    let contadorQuejas = 0; // Contador global para generar índices únicos

    // Seleccionamos todos los checkboxes de quejas
    const checkboxes = document.querySelectorAll(".queja-checkbox");
    const container = document.getElementById("quejas-container");

    checkboxes.forEach(checkbox => {
      checkbox.addEventListener("change", function () {
        const queja = this.value; // Obtiene el valor del checkbox (nombre de la queja)
        const quejaId = `queja-${contadorQuejas}`; // ID único para los campos

        if (this.checked) {
          // Verifica si ya existe la sección antes de agregarla
          if (!document.getElementById(quejaId)) {
            // Crea el formulario dinámico
            const section = document.createElement("div");
            section.id = quejaId;
            section.classList.add("pl-4", "mt-3", "border", "p-2");

            section.innerHTML = `
          <h5>${queja}</h5>
          <div class="form-group">
            <label>¿Cuándo inició?</label>
            <input type="text" class="form-control" name="inicio_${contadorQuejas}">
          </div>
          <div class="form-group">
            <label>Cómo ha evolucionado</label>
            <textarea class="form-control" name="evolucion_${contadorQuejas}" rows="2"></textarea>
          </div>
          <div class="form-group">
            <label>Frecuencia Semana</label>
            <select class="form-control" name="frecuencia_${contadorQuejas}">
              <option value="1">Una vez</option>
              <option value="2-3">2-3 veces</option>
              <option value="4-5">4-5 veces</option>
              <option value="5+">Más de 5 veces</option>
            </select>
          </div>
          <div class="form-group">
            <label>Gravedad</label>
            <select class="form-control" name="gravedad_${contadorQuejas}">
              <option value="Leve">Leve</option>
              <option value="Moderado">Moderado</option>
              <option value="Grave">Grave</option>
            </select>
          </div>
        `;

            container.appendChild(section);
            contadorQuejas++; // Incrementar el contador para la próxima queja
          }
        } else {
          // Si se desmarca, eliminar la sección de la queja
          const sectionToRemove = document.getElementById(quejaId);
          if (sectionToRemove) {
            sectionToRemove.remove();
          }
        }
      });
    });


    ///////////////////////////////////////////////////////////////

    // Referencias a los elementos del formulario
    const consumeSi = document.getElementById("consume-si");
    const consumeNo = document.getElementById("consume-no");
    const camposComidaContainer = document.getElementById("campos-comida-container");
    const agregarSustanciaBtn = document.getElementById("agregar-sustancia");
    const contenedorSustancias = document.getElementById("contenedor-sustancias");

    // Función para mostrar u ocultar los campos adicionales
    function toggleCamposComida() {
      if (consumeSi.checked) {
        camposComidaContainer.style.display = "block";
      } else {
        camposComidaContainer.style.display = "none";
        // Limpiar el contenedor de sustancias si se selecciona "No"
        contenedorSustancias.innerHTML = "";
      }
    }

    // Función para agregar un nuevo conjunto de campos de sustancia
    let contadorSustancias = 0; // Contador global para generar índices únicos

    function agregarSustancia() {
      const sustanciaHTML = `
    <div class="sustancia-item mb-4 border p-3">
      <div class="form-group">
        <label for="tipo-sustancia">Tipo de sustancia</label>
        <input type="text" class="form-control" name="tipo_sustancia_${contadorSustancias}" required>
      </div>
      <div class="form-group">
        <label for="cantidad-sustancia">Cantidad</label>
        <input type="text" class="form-control" name="cantidad_sustancia_${contadorSustancias}" required>
      </div>
      <div class="form-group"> 
        <label for="frecuencia-sustancia">Frecuencia a la semana</label>
        <select class="form-control" name="frecuencia_sustancia_${contadorSustancias}" required>
          <option value="1 vez a la semana">1 vez a la semana</option>
          <option value="1-3 veces a la semana">1-3 veces a la semana</option>
          <option value="3-5 veces a la semana">3-5 veces a la semana</option>
          <option value="> 5 veces a la semana">> 5 veces a la semana</option>
        </select>
      </div>
      <div class="form-group">
        <label for="tiempo-sustancia">¿Cuánto tiempo antes de dormir?</label>
        <select class="form-control" name="tiempo_sustancia_${contadorSustancias}" required>
          <option value="Antes de dormir">Antes de dormir</option>
          <option value="< 15 minutos antes">< 15 minutos antes</option>
          <option value="15-30 minutos antes">15-30 minutos antes</option>
          <option value="30-60 minutos antes">30-60 minutos antes</option>
          <option value="1-2 horas antes">1-2 horas antes</option>
          <option value="Más de 2 horas antes">Más de 2 horas antes</option>
        </select>
      </div>
      <div class="form-group">
        <label for="observaciones-sustancia">Observaciones</label>
        <textarea class="form-control" name="observaciones_sustancia_${contadorSustancias}" rows="2"></textarea>
      </div>
      <button type="button" class="btn btn-danger btn-sm eliminar-sustancia">Eliminar</button>
    </div>
  `;
      contenedorSustancias.insertAdjacentHTML("beforeend", sustanciaHTML);
      contadorSustancias++; // Incrementar el contador para la próxima sustancia
    }
    // Función para eliminar un conjunto de campos de sustancia
    function eliminarSustancia(event) {
      if (event.target.classList.contains("eliminar-sustancia")) {
        event.target.closest(".sustancia-item").remove();
      }
    }

    // Escuchar cambios en los radio buttons
    consumeSi.addEventListener("change", toggleCamposComida);
    consumeNo.addEventListener("change", toggleCamposComida);

    // Escuchar clic en el botón "Agregar sustancia"
    agregarSustanciaBtn.addEventListener("click", agregarSustancia);

    // Escuchar clic en el contenedor de sustancias para eliminar
    contenedorSustancias.addEventListener("click", eliminarSustancia);

    // Inicializar el estado al cargar la página
    toggleCamposComida();

    ///////////////////////////////////////////////////////////////////

    let contadorMedicamentos = 0; // Contador para identificar cada medicamento

    // Referencias a los elementos del formulario
    const consumeSi1 = document.getElementById("consume_si");
    const consumeNo2 = document.getElementById("consume_no");
    const agregarMedicamentoBtn = document.getElementById("agregar-medicamento");
    const contenedorMedicamentos = document.getElementById("contenedor-medicamentos");

    // Función para mostrar u ocultar el botón "Agregar Medicamento"
    function toggleAgregarMedicamento() {
      if (consumeSi1.checked) {
        agregarMedicamentoBtn.style.display = "block"; // Mostrar el botón
      } else {
        agregarMedicamentoBtn.style.display = "none"; // Ocultar el botón
        contenedorMedicamentos.innerHTML = ""; // Limpiar el contenedor de medicamentos
        contadorMedicamentos = 0; // Reiniciar el contador
      }
    }

    // Función para agregar un nuevo medicamento
    function agregarMedicamento() {
      contadorMedicamentos++; // Incrementar el contador

      // Crear un nuevo div para el medicamento
      const nuevoMedicamento = document.createElement("div");
      nuevoMedicamento.classList.add("border", "p-3", "mb-3");
      nuevoMedicamento.innerHTML = `
    <h5>Medicamento ${contadorMedicamentos}</h5>
    <div class="form-group">
      <label>Nombre del medicamento</label>
      <input type="text" class="form-control" name="nombre_medicamento[]" placeholder="Ej. Paracetamol" required>
    </div>
    <div class="form-group">
      <label>Dosis / Concentración</label>
      <input type="text" class="form-control" name="dosis_medicamento[]" placeholder="Ej. 500mg" required>
    </div>
    <div class="form-group">
      <label>Presentación</label>
      <select class="form-control" name="presentacion[]">
        <option value="">Seleccione una opción</option>
        <option value="Tabletas">Tabletas</option>
        <option value="Cápsulas">Cápsulas</option>
        <option value="Solución">Solución</option>
      </select>
    </div>
    <div class="form-group">
      <label>Número de veces al día</label>
      <input type="number" class="form-control" name="veces_dia[]" min="1" required>
    </div>
    <div class="form-group">
      <label>Frecuencia</label>
      <select class="form-control" name="frecuencia_medicamentos[]">
        <option value="">Seleccione una opción</option>
        <option value="1 vez a la semana">1 vez a la semana</option>
        <option value="1-3 veces a la semana">1-3 veces a la semana</option>
        <option value="3-5 veces a la semana">3-5 veces a la semana</option>
        <option value="Más de 5 veces a la semana">Más de 5 veces a la semana</option>
      </select>
    </div>
    <div class="form-group">
      <label>Tiempo antes de dormir</label>
      <select class="form-control" name="tiempo_antes_dormir[]">
        <option value="">Seleccione una opción</option>
        <option value="Antes de dormir">Antes de dormir</option>
        <option value="15 minutos antes">15 minutos antes</option>
        <option value="Entre 15 - 30 minutos antes">Entre 15 - 30 minutos antes</option>
        <option value="Entre 30 y 60 minutos antes">Entre 30 y 60 minutos antes</option>
        <option value="Entre 1 a 2 horas antes">Entre 1 a 2 horas antes</option>
        <option value="Más de 2 horas antes">Más de 2 horas antes</option>
      </select>
    </div>
    <div class="form-group">
      <label>Observaciones</label>
      <textarea class="form-control" name="observaciones_medicamento[]" rows="2"></textarea>
    </div>
    <button type="button" class="btn btn-danger btn-sm eliminar-medicamento">Eliminar</button>
  `;

      // Agregar el nuevo medicamento al contenedor
      contenedorMedicamentos.appendChild(nuevoMedicamento);
    }

    // Función para eliminar un medicamento
    function eliminarMedicamento(event) {
      if (event.target.classList.contains("eliminar-medicamento")) {
        event.target.closest("div.border").remove(); // Elimina el div que contiene el medicamento
      }
    }

    // Escuchar cambios en los radio buttons
    consumeSi1.addEventListener("change", toggleAgregarMedicamento);
    consumeNo2.addEventListener("change", toggleAgregarMedicamento);

    // Escuchar clic en el botón "Agregar Medicamento"
    agregarMedicamentoBtn.addEventListener("click", agregarMedicamento);

    // Escuchar clic en el contenedor de medicamentos para eliminar
    contenedorMedicamentos.addEventListener("click", eliminarMedicamento);

    // Inicializar el estado al cargar la página
    toggleAgregarMedicamento();




    /////////////////////////////////////////////////////////////
    let contadorPantallas = 0; // Contador para identificar cada pantalla

    // Referencias a los elementos del formulario
    const pantallasSi = document.getElementById("pantallas_si");
    const pantallasNo = document.getElementById("pantallas_no");
    const agregarPantallaBtn = document.getElementById("agregar-pantalla");
    const contenedorPantallas = document.getElementById("contenedor-pantallas");

    // Función para mostrar u ocultar el botón "Agregar Pantalla"
    function toggleAgregarPantalla() {
      if (pantallasSi.checked) {
        agregarPantallaBtn.style.display = "block"; // Mostrar el botón
      } else {
        agregarPantallaBtn.style.display = "none"; // Ocultar el botón
        contenedorPantallas.innerHTML = ""; // Limpiar el contenedor de pantallas
        contadorPantallas = 0; // Reiniciar el contador
      }
    }

    // Función para agregar una nueva pantalla
    function agregarPantalla() {
      contadorPantallas++; // Incrementar el contador

      // Crear un nuevo div para la pantalla
      const nuevaPantalla = document.createElement("div");
      nuevaPantalla.classList.add("border", "p-3", "mb-3");
      nuevaPantalla.innerHTML = `
  <h5>Pantalla ${contadorPantallas}</h5>
  <div class="form-group">
    <label>Tipo de pantalla</label>
    <select class="form-control tipo-pantalla" name="tipo_pantalla[]">
      <option value="">Selecciona una opción</option>
      <option value="celular">Celular</option>
      <option value="televisor">Televisor</option>
      <option value="computador">Computador</option>
      <option value="videojuegos">Videojuegos</option>
      <option value="tablet">Ipad / Tablet</option>
    </select>
  </div>
  <div class="form-group">
    <label>Frecuencia a la semana</label>
    <select class="form-control frecuencia" name="pantalla_frecuencia[]">
      <option value="">Selecciona una opción</option>
      <option value="1 vez a la semana">1 vez a la semana</option>
      <option value="1-3 veces a la semana">1-3 veces a la semana</option>
      <option value="3-5 veces a la semana">3-5 veces a la semana</option>
      <option value="Más de 5 veces a la semana">Más de 5 veces a la semana</option>
    </select>
  </div>
  <div class="form-group">
    <label>¿Cuánto tiempo antes de dormir?</label>
    <select class="form-control tiempo-dormir" name="pantalla_tiempo_dormir[]">
      <option value="">Selecciona una opción</option>
      <option value="Antes de dormir">Antes de dormir</option>
      <option value="< 15 minutos antes">&lt; 15 minutos antes</option>
      <option value="Entre 15 - 30 minutos antes">Entre 15 - 30 minutos antes</option>
      <option value="Entre 30 y 60 minutos antes">Entre 30 y 60 minutos antes</option>
      <option value="Entre 1 a 2 horas antes">Entre 1 a 2 horas antes</option>
      <option value="Más de 2 horas antes">Más de 2 horas antes</option>
    </select>
  </div>
  <button type="button" class="btn btn-danger btn-sm eliminar-pantalla">Eliminar</button>
`;

      // Agregar la nueva pantalla al contenedor
      contenedorPantallas.appendChild(nuevaPantalla);
    }

    // Función para eliminar una pantalla
    function eliminarPantalla(event) {
      if (event.target.classList.contains("eliminar-pantalla")) {
        event.target.closest("div.border").remove(); // Elimina el div que contiene la pantalla
      }
    }

    // Escuchar cambios en los radio buttons
    pantallasSi.addEventListener("change", toggleAgregarPantalla);
    pantallasNo.addEventListener("change", toggleAgregarPantalla);

    // Escuchar clic en el botón "Agregar Pantalla"
    agregarPantallaBtn.addEventListener("click", agregarPantalla);

    // Escuchar clic en el contenedor de pantallas para eliminar
    contenedorPantallas.addEventListener("click", eliminarPantalla);

    // Inicializar el estado al cargar la página
    toggleAgregarPantalla();


    ////////////////////////////////////////////////////////////////////
    let contadorActividades = 0; // Contador para identificar cada actividad

    // Referencias a los elementos del formulario
    const camaActividadesSi = document.getElementById("cama_actividades_si");
    const camaActividadesNo = document.getElementById("cama_actividades_no");
    const agregarActividadBtn = document.getElementById("agregar-actividad");
    const contenedorActividades = document.getElementById("contenedor-actividades");

    // Función para mostrar u ocultar el botón "Agregar Actividad"
    function toggleAgregarActividad() {
      if (camaActividadesSi.checked) {
        agregarActividadBtn.style.display = "block"; // Mostrar el botón
      } else {
        agregarActividadBtn.style.display = "none"; // Ocultar el botón
        contenedorActividades.innerHTML = ""; // Limpiar el contenedor de actividades
        contadorActividades = 0; // Reiniciar el contador
      }
    }

    // Función para agregar una nueva actividad
    function agregarActividad() {
      contadorActividades++; // Incrementar el contador

      // Crear un nuevo div para la actividad
      const nuevaActividad = document.createElement("div");
      nuevaActividad.classList.add("border", "p-3", "mb-3");
      nuevaActividad.innerHTML = `
  <h5>Actividad ${contadorActividades}</h5>
<div class="form-group">
  <label for="tipo_actividad_${contadorActividades}">Tipo de actividad</label>
  <select class="form-control" id="tipo_actividad_${contadorActividades}" name="tipo_actividad[]" multiple>
    <option value="comer">Comer</option>
    <option value="videojuegos">Jugar videojuegos</option>
    <option value="peliculas">Ver películas/series</option>
    <option value="internet">Navegar en internet</option>
    <option value="redes">Revisar redes sociales</option>
    <option value="leer">Leer</option>
    <option value="estudiar">Estudiar</option>
    <option value="yoga">Estiramientos/Yoga</option>
    <option value="teletrabajo">Teletrabajo</option>
    <option value="otros">Otros</option>
  </select>
</div>

<div class="form-group">
  <label for="frecuencia_${contadorActividades}">Frecuencia a la semana</label>
  <select class="form-control" id="frecuencia_${contadorActividades}" name="frecuencia_actividad[]">
    <option value="1 vez">1 vez a la semana</option>
    <option value="1-3 veces">1-3 veces a la semana</option>
    <option value="3-5 veces">3-5 veces a la semana</option>
    <option value="más de 5">Más de 5 veces a la semana</option>
  </select>
</div>

<div class="form-group">
  <label for="observaciones_${contadorActividades}">Observaciones</label>
  <textarea class="form-control" id="observaciones_${contadorActividades}" name="observaciones_actividades[]" rows="2"></textarea>
</div>

<button type="button" class="btn btn-danger btn-sm eliminar-actividad">Eliminar</button>`;

      // Agregar la nueva actividad al contenedor
      contenedorActividades.appendChild(nuevaActividad);
    }

    // Función para eliminar una actividad
    function eliminarActividad(event) {
      if (event.target.classList.contains("eliminar-actividad")) {
        event.target.closest("div.border").remove(); // Elimina el div que contiene la actividad
      }
    }

    // Escuchar cambios en los radio buttons
    camaActividadesSi.addEventListener("change", toggleAgregarActividad);
    camaActividadesNo.addEventListener("change", toggleAgregarActividad);

    // Escuchar clic en el botón "Agregar Actividad"
    agregarActividadBtn.addEventListener("click", agregarActividad);

    // Escuchar clic en el contenedor de actividades para eliminar
    contenedorActividades.addEventListener("click", eliminarActividad);

    // Inicializar el estado al cargar la página
    toggleAgregarActividad();

    //////////////////////////////////////////////

    let contadorActividadesFisicas = 0; // Contador para identificar cada actividad física

    // Referencias a los elementos del formulario
    const actividadFisicaSi = document.getElementById("actividad_fisica_si");
    const actividadFisicaNo = document.getElementById("actividad_fisica_no");
    const agregarActividadFisicaBtn = document.getElementById("agregar-actividad-fisica");
    const contenedorActividadesFisicas = document.getElementById("contenedor-actividades-fisicas");

    // Función para mostrar u ocultar el botón "Agregar Actividad Física"
    function toggleAgregarActividadFisica() {
      if (actividadFisicaSi.checked) {
        agregarActividadFisicaBtn.style.display = "block"; // Mostrar el botón
      } else {
        agregarActividadFisicaBtn.style.display = "none"; // Ocultar el botón
        contenedorActividadesFisicas.innerHTML = ""; // Limpiar el contenedor de actividades físicas
        contadorActividadesFisicas = 0; // Reiniciar el contador
      }
    }

    // Función para agregar una nueva actividad física
    function agregarActividadFisica() {
      contadorActividadesFisicas++; // Incrementar el contador

      // Crear un nuevo div para la actividad física
      const nuevaActividadFisica = document.createElement("div");
      nuevaActividadFisica.classList.add("border", "p-3", "mb-3");
      nuevaActividadFisica.innerHTML = `
      <div class="form-group">
  <h5>Actividad Física ${contadorActividadesFisicas}</h5>
  <div class="form-row">
    <div class="col-md-6">
      <label>Tipo de actividad</label>
      <select class="form-control" name="tipo_actividad_fisica[]">
        <option value="" disabled selected>Seleccione una actividad</option>
        <option value="pesas">Levantamiento de pesas</option>
        <option value="deportes">Deportes colectivos</option>
        <option value="natacion">Natación</option>
        <option value="correr">Correr/trotar</option>
        <option value="ciclismo">Ciclismo</option>
        <option value="yoga">Estiramiento/yoga</option>
        <option value="otro">Otro (Especificar)</option>
      </select>
      <input type="text" class="form-control mt-2 d-none" name="tipo_actividad_otro_texto[]" placeholder="Especificar">
    </div>
    <div class="col-md-3">
      <label>Intensidad (1-10)</label>
      <input type="number" class="form-control" name="intensidad_fisica[]" min="1" max="10" required>
    </div>
    <div class="col-md-3">
      <label>Frecuencia</label>
      <select class="form-control" name="frecuencia_fisica[]">
        <option value="" disabled selected>Seleccione</option>
        <option value="1">1 vez a la semana</option>
        <option value="1-3">1-3 veces a la semana</option>
        <option value="3-5">3-5 veces a la semana</option>
        <option value="mas_5">Más de 5 veces a la semana</option>
      </select>
    </div>
  </div>
  <div class="form-group mt-3">
    <label>Observaciones</label>
    <textarea class="form-control" name="observaciones_actividad_fisica[]" rows="2"></textarea>
  </div>
  <button type="button" class="btn btn-danger btn-sm eliminar-actividad-fisica">Eliminar</button>
</div>
  `;

      // Agregar la nueva actividad física al contenedor
      contenedorActividadesFisicas.appendChild(nuevaActividadFisica);
    }

    // Función para eliminar una actividad física
    function eliminarActividadFisica(event) {
      if (event.target.classList.contains("eliminar-actividad-fisica")) {
        event.target.closest("div.border").remove(); // Elimina el div que contiene la actividad física
      }
    }

    // Escuchar cambios en los radio buttons
    actividadFisicaSi.addEventListener("change", toggleAgregarActividadFisica);
    actividadFisicaNo.addEventListener("change", toggleAgregarActividadFisica);

    // Escuchar clic en el botón "Agregar Actividad Física"
    agregarActividadFisicaBtn.addEventListener("click", agregarActividadFisica);

    // Escuchar clic en el contenedor de actividades físicas para eliminar
    contenedorActividadesFisicas.addEventListener("click", eliminarActividadFisica);

    // Inicializar el estado al cargar la página
    toggleAgregarActividadFisica();

    ////////////////////////////////////////////////////////////////////////////////////
    let contadorSintomas = 0; // Contador para identificar cada síntoma

    // Referencias a los elementos del formulario
    const sintomasSuenoSi = document.getElementById("sintomas_sueno_si");
    const sintomasSuenoNo = document.getElementById("sintomas_sueno_no");
    const agregarSintomaBtn = document.getElementById("agregar-sintoma");
    const contenedorSintomas = document.getElementById("contenedor-sintomas");

    // Función para mostrar u ocultar el botón "Agregar Síntoma"
    function toggleAgregarSintoma() {
      if (sintomasSuenoSi.checked) {
        agregarSintomaBtn.style.display = "block"; // Mostrar el botón
      } else {
        agregarSintomaBtn.style.display = "none"; // Ocultar el botón
        contenedorSintomas.innerHTML = ""; // Limpiar el contenedor de síntomas
        contadorSintomas = 0; // Reiniciar el contador
      }
    }

    // Función para agregar un nuevo síntoma
    function agregarSintoma() {
      contadorSintomas++; // Incrementar el contador

      // Crear un nuevo div para el síntoma
      const nuevoSintoma = document.createElement("div");
      nuevoSintoma.classList.add("border", "p-3", "mb-3");
      nuevoSintoma.innerHTML = `
      <h5>Síntoma ${contadorSintomas}</h5>
      <div class="form-group">
        <label>Tipo de síntoma</label>
        <select class="form-control" name="tipo_sintoma[]" required>
          <option value="">Seleccione un síntoma</option>
          <option value="Cefalea">Cefalea</option>
          <option value="Nicturia">Nicturia</option>
          <option value="Movimiento de extremidades">Movimiento de extremidades</option>
          <option value="Disnea nocturna">Disnea nocturna</option>
          <option value="Parálisis del sueño">Parálisis del sueño</option>
          <option value="Pesadillas">Pesadillas</option>
          <option value="Molestias en las piernas">Molestias en las piernas</option>
          <option value="Ingesta nocturna">Ingesta nocturna</option>
          <option value="Sonambulismo">Sonambulismo</option>
          <option value="Bruxismo">Bruxismo</option>
          <option value="Somniloquia">Somniloquia</option>
          <option value="Micro despertares">Micro despertares</option>
          <option value="Recreación de sueño">Recreación de sueño</option>
          <option value="Congestión nasal">Congestión nasal</option>
          <option value="Respiración oral">Respiración oral</option>
          <option value="Estridor y catatrenia">Estridor y catatrenia</option>
          <option value="Otro">Otro</option>
        </select>
      </div>
   <div class="form-group">
    <label>¿Cuándo inició?</label>
    <input type="text" class="form-control" name="cuando_inicio[]" placeholder="Ej. Hace 3 meses" required>
</div>

<div class="form-group">
    <label>¿Cómo ha evolucionado?</label>
    <input type="text" class="form-control" name="evolucion[]" placeholder="Ej. Ha empeorado con el tiempo" required>
</div>

<div class="form-group">
    <label>Frecuencia a la semana</label>
    <select class="form-control" name="frecuencia[]">
        <option value="" disabled selected>Seleccione una opción</option>
        <option value="1">Una vez</option>
        <option value="2-3">2-3 veces</option>
        <option value="4-5">4-5 veces</option>
        <option value="más de 5">Más de 5 veces</option>
    </select>
</div>

<div class="form-group">
    <label>Gravedad</label>
    <select class="form-control" name="gravedad[]">
        <option value="" disabled selected>Seleccione una opción</option>
        <option value="leve">Leve</option>
        <option value="moderado">Moderado</option>
        <option value="grave">Grave</option>
    </select>
</div>

<div class="form-group">
    <label>Observaciones</label>
    <textarea class="form-control" name="observaciones_sintoma[]" rows="2"></textarea>
</div>

<button type="button" class="btn btn-danger btn-sm eliminar-sintoma">Eliminar</button>

    `;

      // Agregar el nuevo síntoma al contenedor
      contenedorSintomas.appendChild(nuevoSintoma);
    }

    // Función para eliminar un síntoma
    function eliminarSintoma(event) {
      if (event.target.classList.contains("eliminar-sintoma")) {
        event.target.closest("div.border").remove(); // Elimina el div que contiene el síntoma
      }
    }

    // Escuchar cambios en los radio buttons
    sintomasSuenoSi.addEventListener("change", toggleAgregarSintoma);
    sintomasSuenoNo.addEventListener("change", toggleAgregarSintoma);

    // Escuchar clic en el botón "Agregar Síntoma"
    agregarSintomaBtn.addEventListener("click", agregarSintoma);

    // Escuchar clic en el contenedor de síntomas para eliminar
    contenedorSintomas.addEventListener("click", eliminarSintoma);

    // Inicializar el estado al cargar la página
    toggleAgregarSintoma();

    let contadorSintomasDiurnos = 0; // Contador para identificar cada síntoma diurno

    // Referencias a los elementos del formulario
    const sintomasDiurnosSi = document.getElementById("sintomas_diurnos_si");
    const sintomasDiurnosNo = document.getElementById("sintomas_diurnos_no");
    const agregarSintomaDiurnoBtn = document.getElementById("agregar-sintoma-diurno");
    const contenedorSintomasDiurnos = document.getElementById("contenedor-sintomas-diurnos");

    // Función para mostrar u ocultar el botón "Agregar Síntoma Diurno"
    function toggleAgregarSintomaDiurno() {
      if (sintomasDiurnosSi.checked) {
        agregarSintomaDiurnoBtn.style.display = "block"; // Mostrar el botón
      } else {
        agregarSintomaDiurnoBtn.style.display = "none"; // Ocultar el botón
        contenedorSintomasDiurnos.innerHTML = ""; // Limpiar el contenedor de síntomas diurnos
        contadorSintomasDiurnos = 0; // Reiniciar el contador
      }
    }

    // Función para agregar un nuevo síntoma diurno
    function agregarSintomaDiurno() {
      contadorSintomasDiurnos++; // Incrementar el contador

      // Crear un nuevo div para el síntoma diurno
      const nuevoSintomaDiurno = document.createElement("div");
      nuevoSintomaDiurno.classList.add("border", "p-3", "mb-3");
      nuevoSintomaDiurno.innerHTML = `
      <h5>Síntoma Diurno ${contadorSintomasDiurnos}</h5>
      <div class="form-group">
        <label>Tipo de síntoma</label>
        <select class="form-control" name="tipo_sintoma_diurno[]" required>
          <option value="">Seleccione un síntoma</option>
          <option value="Somnolencia diurna">Somnolencia diurna</option>
          <option value="Trastorno del humor">Trastorno del humor</option>
          <option value="Disminución de la productividad">Disminución de la productividad</option>
          <option value="Alteración de las relaciones personales">Alteración de las relaciones personales</option>
          <option value="Trastorno de la memoria">Trastorno de la memoria</option>
          <option value="Trastorno de la atención">Trastorno de la atención</option>
        </select>
      </div>
    <div class="form-group">
  <label>¿Cuándo inició?</label>
  <input type="text" class="form-control" name="cuando_inicio_diurno[]" placeholder="Ej. Hace 3 meses" required>
</div>

<div class="form-group">
  <label>¿Cómo ha evolucionado?</label>
  <input type="text" class="form-control" name="evolucion_diurno[]" placeholder="Ej. Ha empeorado con el tiempo" required>
</div>

<div class="form-group">
  <label>Frecuencia a la semana</label>
  <select class="form-control" name="frecuencia_diurno[]">
    <option value="">Seleccione una opción</option>
    <option value="1">Una vez</option>
    <option value="2-3">2-3 veces</option>
    <option value="4-5">4-5 veces</option>
    <option value="más de 5">Más de 5 veces</option>
  </select>
</div>

<div class="form-group">
  <label>Gravedad</label>
  <select class="form-control" name="gravedad_diurno[]">
    <option value="">Seleccione una opción</option>
    <option value="leve">Leve</option>
    <option value="moderado">Moderado</option>
    <option value="grave">Grave</option>
  </select>
</div>

<div class="form-group">
  <label>Observaciones</label>
  <textarea class="form-control" name="observaciones_sintoma_diurno[]" rows="2"></textarea>
</div>

<button type="button" class="btn btn-danger btn-sm eliminar-sintoma">Eliminar</button>
    `;

      // Agregar el nuevo síntoma diurno al contenedor
      contenedorSintomasDiurnos.appendChild(nuevoSintomaDiurno);
    }

    // Función para eliminar un síntoma diurno
    function eliminarSintomaDiurno(event) {
      if (event.target.classList.contains("eliminar-sintoma-diurno")) {
        event.target.closest("div.border").remove(); // Elimina el div que contiene el síntoma diurno
      }
    }

    // Escuchar cambios en los radio buttons
    sintomasDiurnosSi.addEventListener("change", toggleAgregarSintomaDiurno);
    sintomasDiurnosNo.addEventListener("change", toggleAgregarSintomaDiurno);

    // Escuchar clic en el botón "Agregar Síntoma Diurno"
    agregarSintomaDiurnoBtn.addEventListener("click", agregarSintomaDiurno);

    // Escuchar clic en el contenedor de síntomas diurnos para eliminar
    contenedorSintomasDiurnos.addEventListener("click", eliminarSintomaDiurno);

    // Inicializar el estado al cargar la página
    toggleAgregarSintomaDiurno();
  });
</script>
{% endblock javascripts %}
{% endblock content %}